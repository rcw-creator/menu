<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Town Calendar</title>
<style>
  body {
    margin: 0;
    font-family: "Segoe UI", sans-serif;
    background: linear-gradient(135deg, #b1d0e0, #f6f9fc);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .calendar-card {
    position: relative;
    width: 320px;
    padding: 20px;
    border-radius: 20px;
    backdrop-filter: blur(12px);
    background: rgba(255, 255, 255, 0.25);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.4);
  }

  .calendar-card h2 {
    margin: 0;
    color: #004a7c;
    font-weight: 700;
    text-align: center;
  }

  .month-nav {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: #0077b6;
    color: white;
    border-radius: 8px;
    margin: 10px 0;
    padding: 6px 10px;
    font-weight: bold;
  }

  .month-nav button {
    background: transparent;
    border: none;
    color: white;
    font-size: 1.2em;
    cursor: pointer;
    width: 24px;
    text-align: center;
    visibility: visible;
  }

  .month-nav button.hidden {
    visibility: hidden; /* instead of display:none to preserve spacing */
  }

  table {
    width: 100%;
    border-collapse: collapse;
    text-align: center;
    font-size: 14px;
  }

  th {
    color: #004a7c;
    font-weight: 600;
    padding-bottom: 6px;
  }

  td {
    position: relative;
    padding: 6px;
    border-radius: 6px;
    color: #004a7c;
    transition: background 0.2s;
  }

  .today {
    background: rgba(255, 230, 150, 0.9);
    border-radius: 8px;
    font-weight: bold;
  }

  .has-event {
    cursor: pointer;
  }

  .has-event:hover {
    background: rgba(255, 255, 255, 0.3);
  }

  .has-event::after {
    content: "";
    position: absolute;
    bottom: 1px;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #00cc88;
    box-shadow: 0 0 5px #00cc88;
  }

  .event-panel {
    position: fixed;
    top: 0;
    right: -350px;
    width: 300px;
    height: 100%;
    background: rgba(255, 255, 255, 0.35);
    backdrop-filter: blur(14px);
    border-left: 1px solid rgba(255, 255, 255, 0.4);
    box-shadow: -4px 0 15px rgba(0, 0, 0, 0.15);
    transition: right 0.4s ease;
    padding: 20px;
    overflow-y: auto;
  }

  .event-panel.active {
    right: 0;
  }

  .event-panel h3 {
    color: #004a7c;
    margin-top: 0;
  }

  .event {
    margin-bottom: 15px;
    padding: 10px;
    background: rgba(255, 255, 255, 0.4);
    border-radius: 10px;
  }

  .event-title {
    font-weight: bold;
  }
</style>
</head>
<body>
  <div class="calendar-card">
    <h2>Town Calendar</h2>
    <div class="month-nav">
      <button id="prevMonth"><</button>
      <span id="monthLabel">October 2025</span>
      <button id="nextMonth">></button>
    </div>

    <table>
      <thead>
        <tr><th>S</th><th>M</th><th>T</th><th>W</th><th>T</th><th>F</th><th>S</th></tr>
      </thead>
      <tbody id="calendarBody"></tbody>
    </table>
  </div>

  <div class="event-panel" id="eventPanel">
    <h3 id="eventTitle">Events</h3>
    <div id="eventList"></div>
  </div>

<script>
  const events = { 
    "2025-09-06": [{ title: "Library Story Hour", desc: "Kids storytelling and crafts at 3 PM." }],
    "2025-09-17": [{ title: "Community Meeting", desc: "Discuss upcoming parade and safety rules." }],
    "2025-10-06": [{ title: "Library Story Hour", desc: "Kids storytelling and crafts at 3 PM." }],
    "2025-10-17": [{ title: "Community Meeting", desc: "Discuss upcoming parade and safety rules." }],
    "2025-10-20": [{ title: "Town Council", desc: "Updates from the mayor, 7 PM at Hall." }],
    "2025-10-23": [{ title: "Fall Festival", desc: "Food stalls, games, and live music!" }],
    "2025-10-28": [{ title: "Halloween Parade", desc: "Family fun with costumes, 4 PM Main St." }],    
    "2025-11-28": [{ title: "Thanksgiving Parade", desc: "Join us downtown for the parade!" }]
  };

  const eventPanel = document.getElementById('eventPanel');
  const eventList = document.getElementById('eventList');
  const monthLabel = document.getElementById('monthLabel');
  const calendarBody = document.getElementById('calendarBody');
  const prevMonth = document.getElementById('prevMonth');
  const nextMonth = document.getElementById('nextMonth');

  const eventMonths = [...new Set(Object.keys(events).map(d => d.slice(0, 7)))].sort();
  let currentDate = new Date();

  function updateNavButtons() {
    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    const currentKey = `${year}-${String(month + 1).padStart(2, '0')}`;
    const currentIndex = eventMonths.indexOf(currentKey);

    prevMonth.classList.toggle("hidden", currentIndex <= 0);
    nextMonth.classList.toggle("hidden", currentIndex >= eventMonths.length - 1);
  }

  function renderCalendar(date) {
    const year = date.getFullYear();
    const month = date.getMonth();
    const today = new Date();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const startDay = firstDay.getDay();
    const totalDays = lastDay.getDate();

    monthLabel.textContent = date.toLocaleString('default', { month: 'long', year: 'numeric' });
    calendarBody.innerHTML = "";

    let row = document.createElement("tr");
    for (let i = 0; i < startDay; i++) row.appendChild(document.createElement("td"));

    for (let d = 1; d <= totalDays; d++) {
      const cell = document.createElement("td");
      cell.textContent = d;
      const fullDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;

      if (events[fullDate]) cell.classList.add("has-event");
      if (d === today.getDate() && month === today.getMonth() && year === today.getFullYear()) {
        cell.classList.add("today");
      }

      cell.addEventListener("mouseenter", () => {
        if (events[fullDate]) {
          eventPanel.classList.add("active");
          eventList.innerHTML = events[fullDate]
            .map(e => `<div class="event"><div class="event-title">${e.title}</div><div>${e.desc}</div></div>`)
            .join('');
          document.getElementById('eventTitle').innerText = `${monthLabel.textContent.split(' ')[0]} ${d} Events`;
        } else {
          eventPanel.classList.remove("active");
        }
      });

      row.appendChild(cell);
      if ((startDay + d) % 7 === 0 || d === totalDays) {
        calendarBody.appendChild(row);
        row = document.createElement("tr");
      }
    }

    updateNavButtons();
  }

  prevMonth.addEventListener('click', () => {
    const currentKey = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
    const index = eventMonths.indexOf(currentKey);
    if (index > 0) {
      const [year, month] = eventMonths[index - 1].split('-').map(Number);
      currentDate = new Date(year, month - 1);
      renderCalendar(currentDate);
    }
  });

  nextMonth.addEventListener('click', () => {
    const currentKey = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
    const index = eventMonths.indexOf(currentKey);
    if (index < eventMonths.length - 1) {
      const [year, month] = eventMonths[index + 1].split('-').map(Number);
      currentDate = new Date(year, month - 1);
      renderCalendar(currentDate);
    }
  });

  eventPanel.addEventListener('mouseleave', () => {
    eventPanel.classList.remove('active');
  });

  // Start on the first event month if current month has no events
  const currentKey = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}`;
  if (!eventMonths.includes(currentKey)) {
    const [year, month] = eventMonths[0].split('-').map(Number);
    currentDate = new Date(year, month - 1);
  }

  renderCalendar(currentDate);
</script>
</body>
</html>
